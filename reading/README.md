# Reading List and Comments

- [E(n) Equivariant Graph Neural Networks](https://arxiv.org/abs/2102.09844)
- [Semi-Equivariant GNN Architectures for Jet Tagging](https://arxiv.org/abs/2202.06941)
- [An Efficient Lorentz Equivariant Graph Neural Network for Jet Tagging](https://arxiv.org/abs/2201.08187)

## [Charged particle tracking via edge-classifying interaction networks](https://arxiv.org/abs/2103.16701)
### Summary
The paper implements the physics-motivated Interaction Network (IN) to a particle tracking task. The proposed architecture is shown to be 
much smaller than extant GNN-based tracking algorithms and also demonstrates excellent performance on metrics measured at each step in the pipeline. 

### Comments and Remarks from the Paper

* Tracking data is naturally represented as graphs -- hits form a 3D point cloud, hypothetical track segments are represented as edges between these hits. 
* A GNN-based tracking pipeline has three major steps:
    1. **Graph Construction:** The hits in the point cloud dataset are mapped to nodes and an edge assignment algorithm forms edges between these nodes. 
    2. **Edge Classification:** The GNN model infers the probability that each edge corresponds to a true track segment.
    3. **Track Building:** Inferred edge probabilities are leveraged to form track candidates. 
* At the graph construction stage, typically a set of *truth filters* are applied to hits before they are assigned to nodes to modulate the number of hits that end up in the final graph. 
    - $p_T$ filters reject hits generated by particles with $p_T < p_T^{\text{min}}$
    - Noise filters reject noise hits (not generated by a particle)
    - Same-layer filters reject all but one hit in a layer
* Metric at GC step: efficiency and purity of the hitgraph
    - **Efficiency** ($= N^{\text{reconstructed}}\_{\text{true}}/N^{\text{possible}}\_{\text{true}}$) is the fraction of track segments represented as true edges;
    - **Purity** ($= N^{\text{reconstructed}}\_{\text{true}}/N^{\text{reconstructed}}\_{\text{total}}$) is the fraction of true edges to total edges in the hitgraph
    - Purity always studied in the context of efficiency as $N^{\text{reconstructed}}_{\text{total}}$ depends on the graph construction algorithm used; tradeoff between the two. 
* Paper studies three graph construction methods: Geometric, Preclustering, and Data-driven; latter has best performance. 
* In the EC step, the model accepts graph inputs and trains itself by minimizing the BCE between the target and prediction. Target $y$ is a vector where $y_e = 1$ if edge $e$ is a true track segment, else $0$. 
* During training, the IN also learns a threshold $\delta^\*$ by minimizing the difference between the TPR and TFR. If $w_k \geq \delta^\*$, $k$ is classified as true, else false. 
* The TB step runs a clustering algorithm like union-find or DBSCAN to cluster hits in the edge-weighted graphs. Hit clusters are then considered to be reconstructed track candidates which can then me matched to simulated particles, if possible. 
* Metrics used at the TB step: LHC Match efficiency, Double-majority efficiency, and Perfect match efficiency (not used commonly).

**Comments**

- The paper presents the pipeline which is to be followed for the project
    * The GC step can be borrowed without any changes, and as a naÃ¯ve guess, the TB step too. 
    * Project mostly focuses on models for the EC step.
- The weight-prediction mechanism in the EC step needs to be integrated with equivariant methods; currently it is not equivariant as intermediate representations are not equivariant themselves. 

## [TrackML Dataset](https://sites.google.com/site/trackmlparticle/)

The dataset comprises multiple independent events, where each event contains simulated measurements (essentially 3D points) of particles
generated in a collision between proton bunches at the [Large Hadron Collider][lhc] at [CERN][cern]. The goal is to group the recorded measurements or hits for each event into tracks, sets of hits that belong to the same initial particle. A solution must uniquely associate each hit to one track. The training dataset contains the recorded hits, their ground truth counterpart and their association to particles, and the initial parameters of those particles. The test dataset contains only the recorded hits.

Each dataset is usually provided as a single archive file. Once unzipped, the dataset comprises a set of `.csv[.gz]` files. Each event
can have up to four associated files that contain hits, hit cells, particles, and the ground truth association between them. The common
prefix, e.g. `event000000010`, is always `event` followed by 9 digits.

    event000000000-hits.csv
    event000000000-cells.csv
    event000000000-particles.csv
    event000000000-truth.csv
    event000000001-hits.csv
    event000000001-cells.csv
    event000000001-particles.csv
    event000000001-truth.csv

#### Event hits

The hits file contains the following values for each hit/entry:

*   **hit_id**: numerical identifier of the hit inside the event.
*   **x, y, z**: measured $x$, $y$, $z$ position (in millimeter) of the hit in
    global coordinates.
*   **volume_id**: numerical identifier of the detector group.
*   **layer_id**: numerical identifier of the detector layer inside the
    group.
*   **module_id**: numerical identifier of the detector module inside
    the layer.

The volume/layer/module id could in principle be deduced from $x$, $y$, $z$. They
are given here to simplify detector-specific data handling.

#### Event truth

The truth file contains the mapping between hits and generating particles and
the true particle state at each measured hit. Each entry maps one hit to one
particle.

*   **hit_id**: numerical identifier of the hit as defined in the hits file.
*   **particle_id**: numerical identifier of the generating particle as defined
    in the particles file. A value of 0 means that the hit did not originate
    from a reconstructible particle, but e.g. from detector noise.
*   **tx, ty, tz** true intersection point in global coordinates (in
    millimeters) between the particle trajectory and the sensitive surface.
*   **tpx, tpy, tpz** true particle momentum (in GeV/c) in the global
    coordinate system at the intersection point. The corresponding vector
    is tangent to the particle trajectory at the intersection point.
*   **weight** per-hit weight used for the scoring metric; total sum of weights
    within one event equals to one.

#### Event particles

The particles files contains the following values for each particle/entry:

*   **particle_id**: numerical identifier of the particle inside the event.
*   **particle_type**: numerical identifier of the particle type; the
    [Particle Data Group Monte Carlo numbering scheme][pdg_mc_numbering]
    is used to identify specific particle types.
*   **vx, vy, vz**: initial position or vertex (in millimeters) in global
    coordinates.
*   **px, py, pz**: initial momentum (in GeV/c) along each global axis.
*   **q**: particle charge (as multiple of the absolute electron charge).
*   **nhits**: number of hits generated by this particle.

All entries contain the generated information or ground truth.

#### Event hit cells

The cells file contains the constituent active detector cells that comprise each
hit. The cells can be used to refine the hit to track association.
A cell is the smallest granularity inside each detector module, much like a
pixel on a screen, except that depending on the **volume_id** a cell can be a square
or a long rectangle. It is identified by two channel identifiers that are unique
within each detector module and encode the position, much like column/row
numbers of a matrix. A cell can provide signal information that the detector
module has recorded in addition to the position. Depending on the detector type
only one of the channel identifiers is valid, e.g. for the strip detectors, and
the value might have different resolution.

*   **hit_id**: numerical identifier of the hit as defined in the hits file.
*   **ch0, ch1**: channel identifier/coordinates unique within one module.
*   **value**: signal value information, e.g. how much charge a particle has
    deposited

[cern]: https://home.cern
[lhc]: https://home.cern/topics/large-hadron-collider
[pdg_mc_numbering]: http://pdg.lbl.gov/2018/reviews/rpp2018-rev-monte-carlo-numbering.pdf